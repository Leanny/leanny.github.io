<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <!-- Bootstrap CSS -->
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
            integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N"
            crossorigin="anonymous"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
        />
        <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.0/dist/bootstrap-table.min.css" />
        <script
            src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"
            integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
            crossorigin="anonymous"
        ></script>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
            crossorigin="anonymous"
        ></script>
        <script src="https://unpkg.com/bootstrap-table@1.21.0/dist/bootstrap-table.min.js"></script>
        <script defer src="js/dist/json-formatter.umd.js" charset="UTF-8"></script>

        <title>Splatoon 3 - Weapon and Gear Database</title>
        <style>
            .bd-placeholder-img {
                font-size: 1.125rem;
                text-anchor: middle;
                -webkit-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
            }
            @media (min-width: 768px) {
                .bd-placeholder-img-lg {
                    font-size: 3.5rem;
                }
            }
            .themed-grid-col {
                padding-top: 15px;
                padding-bottom: 15px;
                background-color: rgba(86, 61, 124, 0.15);
                border: 1px solid rgba(86, 61, 124, 0.2);
            }
        </style>
    </head>
    <body>
        <nav class="navbar navbar-expand-md navbar-dark bg-dark">
            <a class="navbar-brand" href="#">Weapon and Gear Database</a>
            <button
                class="navbar-toggler"
                type="button"
                data-toggle="collapse"
                data-target="#navbarCollapse"
                aria-controls="navbarCollapse"
                aria-expanded="false"
                aria-label="Toggle navigation"
            >
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse"></div>
        </nav>
        <main role="main">
            <div class="jumbotron">
                <div class="col-sm-8 mx-auto">
                    <div id="updateNote"></div>
                    <h1>Splatoon 3 - Weapon and Gear Database</h1>
                    <div class="toolbar">
                        <select class="form-control" id="language"></select>
                        <select class="form-control" id="version"></select>
                    </div>
                    <ul class="nav nav-tabs" id="modes" role="tablist">
                        <li class="nav-item">
                            <a
                                class="nav-link active"
                                id="weapons-tab"
                                data-toggle="tab"
                                href="#weapons"
                                role="tab"
                                aria-controls="weapons"
                                aria-selected="true"
                                >General Weapon Info</a
                            >
                        </li>
                        <li class="nav-item">
                            <a
                                class="nav-link"
                                id="heads-tab"
                                data-toggle="tab"
                                href="#heads"
                                role="tab"
                                aria-controls="heads"
                                aria-selected="false"
                                >Heads</a
                            >
                        </li>
                        <li class="nav-item">
                            <a
                                class="nav-link"
                                id="clothes-tab"
                                data-toggle="tab"
                                href="#clothes"
                                role="tab"
                                aria-controls="clothes"
                                aria-selected="false"
                                >Clothes</a
                            >
                        </li>
                        <li class="nav-item">
                            <a
                                class="nav-link"
                                id="shoes-tab"
                                data-toggle="tab"
                                href="#shoes"
                                role="tab"
                                aria-controls="shoes"
                                aria-selected="false"
                                >Shoes</a
                            >
                        </li>
                    </ul>
                    <div class="tab-content" id="modeTabControl">
                        <div
                            class="tab-pane fade show active"
                            id="weapons"
                            role="tabpanel"
                            aria-labelledby="weapons-tab"
                        >
                            <div class="table-responsive">
                                <table
                                    class="table table-striped table-hover"
                                    id="weapon-table"
                                    data-sortable="true"
                                    data-search="true"
                                    data-show-columns="true"
                                    data-show-pagination-switch="true"
                                    data-show-fullscreen="true"
                                >
                                    <thead>
                                        <tr>
                                            <th scope="col" data-field="Id" data-sortable="true" data-visible="false">
                                                Internal ID
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="NameClean"
                                                data-formatter="imgFormatter"
                                                data-sortable="false"
                                            >
                                                Image
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="InternalName"
                                                data-sortable="true"
                                                data-visible="false"
                                            >
                                                Internal Name
                                            </th>
                                            <th scope="col" data-field="Name" data-sortable="true">Name</th>
                                            <th
                                                scope="col"
                                                data-field="Sub"
                                                data-formatter="subFormatter"
                                                data-sortable="true"
                                            >
                                                Sub
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="Special"
                                                data-formatter="specialFormatter"
                                                data-sortable="true"
                                            >
                                                Special
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="RewardLvl2"
                                                data-formatter="zakkaFormatter"
                                                data-sortable="true"
                                            >
                                                Reward Lvl 2
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="RewardLvl3"
                                                data-formatter="zakkaFormatter"
                                                data-sortable="true"
                                            >
                                                Reward Lvl 3
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="RewardLvl4"
                                                data-formatter="badgeFormatter"
                                                data-sortable="true"
                                            >
                                                Reward Lvl 4
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="RewardLvl5"
                                                data-formatter="badgeFormatter"
                                                data-sortable="true"
                                            >
                                                Reward Lvl 5
                                            </th>
                                            <th scope="col" data-field="Range" data-sortable="true">
                                                Matchmaking Range
                                            </th>
                                            <th scope="col" data-field="Season" data-sortable="true">Season</th>
                                            <th scope="col" data-field="ShopUnlockRank" data-sortable="true">
                                                Unlock Level
                                            </th>
                                            <th scope="col" data-field="SpecialPoint" data-sortable="true">
                                                Special Points
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="UIParam"
                                                data-formatter="UIParamFormatter"
                                                data-sortable="false"
                                            >
                                                Parameters
                                            </th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="subweapons" role="tabpanel" aria-labelledby="subweapon-tab">
                            <div class="table-responsive">
                                <table
                                    class="table table-striped table-hover"
                                    id="subweapon-table"
                                    data-sortable="true"
                                    data-search="true"
                                    data-show-columns="true"
                                    data-show-pagination-switch="true"
                                    data-show-fullscreen="true"
                                >
                                    <thead>
                                        <tr>
                                            <th scope="col" data-field="Id" data-sortable="true" data-visible="false">
                                                Internal ID
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="NameClean"
                                                data-formatter="subimgFormatter"
                                                data-sortable="false"
                                            >
                                                Image
                                            </th>
                                            <th scope="col" data-field="Name" data-sortable="true">Name</th>
                                            <th scope="col" data-field="InkSaverType" data-sortable="true">
                                                Ink Saver Type
                                            </th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="heads" role="tabpanel" aria-labelledby="heads-tab">
                            <div class="table-responsive">
                                <table
                                    class="table table-striped table-hover"
                                    id="heads-table"
                                    data-sortable="true"
                                    data-search="true"
                                    data-show-columns="true"
                                    data-show-pagination-switch="true"
                                    data-show-fullscreen="true"
                                >
                                    <thead>
                                        <tr>
                                            <th scope="col" data-field="Id" data-sortable="true" data-visible="false">
                                                Internal ID
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="NameClean"
                                                data-formatter="gearimgFormatter"
                                                data-sortable="false"
                                            >
                                                Image
                                            </th>
                                            <th scope="col" data-field="Name" data-sortable="true">Name</th>
                                            <th
                                                scope="col"
                                                data-field="Brand"
                                                data-formatter="brandFormatter"
                                                data-sortable="true"
                                            >
                                                Brand
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="Skill0"
                                                data-formatter="skillFormatter"
                                                data-sortable="true"
                                            >
                                                Main Ability
                                            </th>
                                            <th scope="col" data-field="Price" data-sortable="true">Price</th>
                                            <th scope="col" data-field="Rarity" data-sortable="true">Rarity</th>
                                            <th
                                                scope="col"
                                                data-field="HowToGet"
                                                data-sortable="true"
                                                data-visible="false"
                                            >
                                                How To Get
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="Season"
                                                data-sortable="true"
                                                data-visible="false"
                                            >
                                                Season
                                            </th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="clothes" role="tabpanel" aria-labelledby="clothes-tab">
                            <div class="table-responsive">
                                <table
                                    class="table table-striped table-hover"
                                    id="clothes-table"
                                    data-sortable="true"
                                    data-search="true"
                                    data-show-columns="true"
                                    data-show-pagination-switch="true"
                                    data-show-fullscreen="true"
                                >
                                    <thead>
                                        <tr>
                                            <th scope="col" data-field="Id" data-sortable="true" data-visible="false">
                                                Internal ID
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="NameClean"
                                                data-formatter="gearimgFormatter"
                                                data-sortable="false"
                                            >
                                                Image
                                            </th>
                                            <th scope="col" data-field="Name" data-sortable="true">Name</th>
                                            <th
                                                scope="col"
                                                data-field="Brand"
                                                data-formatter="brandFormatter"
                                                data-sortable="true"
                                            >
                                                Brand
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="Skill0"
                                                data-formatter="skillFormatter"
                                                data-sortable="true"
                                            >
                                                Main Ability
                                            </th>
                                            <th scope="col" data-field="Price" data-sortable="true">Price</th>
                                            <th scope="col" data-field="Rarity" data-sortable="true">Rarity</th>
                                            <th
                                                scope="col"
                                                data-field="HowToGet"
                                                data-sortable="true"
                                                data-visible="false"
                                            >
                                                How To Get
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="Season"
                                                data-sortable="true"
                                                data-visible="false"
                                            >
                                                Season
                                            </th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="shoes" role="tabpanel" aria-labelledby="shoes-tab">
                            <div class="table-responsive">
                                <table
                                    class="table table-striped table-hover"
                                    id="shoes-table"
                                    data-sortable="true"
                                    data-search="true"
                                    data-show-columns="true"
                                    data-show-pagination-switch="true"
                                    data-show-fullscreen="true"
                                >
                                    <thead>
                                        <tr>
                                            <th scope="col" data-field="Id" data-sortable="true" data-visible="false">
                                                Internal ID
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="NameClean"
                                                data-formatter="gearimgFormatter"
                                                data-sortable="false"
                                            >
                                                Image
                                            </th>
                                            <th scope="col" data-field="Name" data-sortable="true">Name</th>
                                            <th
                                                scope="col"
                                                data-field="Brand"
                                                data-formatter="brandFormatter"
                                                data-sortable="true"
                                            >
                                                Brand
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="Skill0"
                                                data-formatter="skillFormatter"
                                                data-sortable="true"
                                            >
                                                Main Ability
                                            </th>
                                            <th scope="col" data-field="Price" data-sortable="true">Price</th>
                                            <th scope="col" data-field="Rarity" data-sortable="true">Rarity</th>
                                            <th
                                                scope="col"
                                                data-field="HowToGet"
                                                data-sortable="true"
                                                data-visible="false"
                                            >
                                                How To Get
                                            </th>
                                            <th
                                                scope="col"
                                                data-field="Season"
                                                data-sortable="true"
                                                data-visible="false"
                                            >
                                                Season
                                            </th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        <script type="module">
            import { generateHeader, generate_migration_info } from "./js/Utility.js"
            generateHeader($("#navbarCollapse"))
            generate_migration_info($("#updateNote"))
        </script>
        <script>
            let prefix = ""
            if (window.location.href.includes("leanny.github.io")) {
                prefix = "https://leanny.github.io/splat3/"
            } else {
                prefix = "http://127.0.0.1:5500/"
            }

            let version = 100

            let lang_dict = {}
            let weapon_data = {}
            let subweapon_data = {}
            let hed_gear = {}
            let clt_gear = {}
            let shs_gear = {}

            const localize = (dir, key) => lang_dict[dir][key]

            const get_image_tag = (img, alt, extra = "") => {
                new_img = img.replace(".png", ".webp")
                return `<picture>
                        <source type="image/webp" srcset="${new_img}" ${extra}>
                        <source type="image/png" srcset="${img}" ${extra}>
                        <img src="${img}" alt="${alt}" ${extra}>
                    </picture>`
            }

            const format_img = (base_url, value, width) =>
                get_image_tag(`${base_url}${value}.png`, "", `width="${width}"`)

            var imgFormatter = value =>
                `<center>${format_img(prefix + "images/weapon_flat/Path_Wst_", value, 96)}</center>`

            var gearimgFormatter = value => `<center>${format_img(prefix + "images/gear/", value, 96)}</center>`

            var skillFormatter = value => {
                const tmp = format_img(prefix + "images/skill/", value, 96)
                return `<center><p>${tmp}<br />${localize("CommonMsg/Gear/GearPowerName", value)}</p></center>`
            }

            var brandFormatter = value => {
                const tmp = format_img(prefix + "images/brand/", value, 64)
                return `<center><p>${tmp}<br />${localize("CommonMsg/Gear/GearBrandName", value)}</p></center>`
            }

            var subimgFormatter = value => `<center>${format_img(prefix + "images/subspe/Wsb_", value, 64)}</center>`

            var subFormatter = value => {
                const tmp = format_img(prefix + "images/subspe/Wsb_", value[0] + "00", 64)
                return `<center><p>${tmp}<br />${value[1]}</p></center>`
            }

            var specialFormatter = value => {
                const tmp = format_img(prefix + "images/subspe/Wsp_", value[0] + "00", 64)
                return `<center><p>${tmp}<br />${value[1]}</p></center>`
            }

            const getFilenameOfReward = value => {
                return value
                    .replace("Work/Gyml/", "")
                    .replace(".gyml", "")
                    .replace("BadgeInfo", "Badge")
                    .replace(".spl__BadgeInfo", "")
                    .replace(".spl__LockerGoodsStickerInfo", "")
            }

            var badgeFormatter = value =>
                `<center>${format_img(prefix + "images/badge/", getFilenameOfReward(value), 96)}</center>`

            var zakkaFormatter = value =>
                `<center>${format_img(prefix + "images/zakka/", getFilenameOfReward(value), 96)}</center>`

            var UIParamFormatter = value => {
                return `<b>${localize("CommonMsg/Weapon/WeaponParamName", value[0]["Type"])}: </b> ${
                    value[0]["Value"]
                }<br /><b>${localize("CommonMsg/Weapon/WeaponParamName", value[1]["Type"])}: </b> ${
                    value[1]["Value"]
                }<br /><b>${localize("CommonMsg/Weapon/WeaponParamName", value[2]["Type"])}: </b> ${
                    value[2]["Value"]
                }<br />`
            }

            var mpuFormatter = value => value[1]

            const languages = [
                {
                    ext: "USen",
                    region: "NA",
                    language: "en",
                    name: "English",
                },
                {
                    ext: "EUen",
                    region: "EU",
                    language: "en",
                    name: "English (UK)",
                },
                {
                    ext: "EUes",
                    region: "EU",
                    language: "es",
                    name: "Español",
                },
                {
                    ext: "USes",
                    region: "NA",
                    language: "es-MX",
                    name: "Español (MX)",
                },
                {
                    ext: "EUfr",
                    region: "EU",
                    language: "fr",
                    name: "Français",
                },
                {
                    ext: "USfr",
                    region: "NA",
                    language: "fr-CA",
                    name: "Français (CA)",
                },
                {
                    ext: "EUde",
                    region: "EU",
                    language: "de",
                    name: "Deutsch",
                },
                {
                    ext: "EUnl",
                    region: "EU",
                    language: "nl",
                    name: "Nederlands",
                },
                {
                    ext: "EUit",
                    region: "EU",
                    language: "it",
                    name: "Italiano",
                },
                {
                    ext: "EUru",
                    region: "EU",
                    language: "ru",
                    name: "Pусский",
                },
                {
                    ext: "JPja",
                    region: "JP",
                    language: "ja",
                    name: "日本語",
                },
                {
                    ext: "CNzh",
                    region: "AP",
                    language: "cn",
                    name: "中文（简体）",
                },
                {
                    ext: "KRko",
                    region: "AP",
                    language: "kr",
                    name: "한국어",
                },
                {
                    ext: "TWzh",
                    region: "AP",
                    language: "tw",
                    name: "中文（繁體）",
                },
            ]

            for (const lang of Object.values(languages)) {
                $("#language").append(new Option(lang["name"], lang["ext"]))
            }

            function detectSplatoonLanguage() {
                let browserLanguages = window.navigator.languages.map(l => l.toLowerCase())
                let availableLanguages = languages.map(l => l.language.toLowerCase())
                let resultLanguages = {}
                for (const lang of Object.values(languages)) {
                    resultLanguages[lang["language"]] = lang["ext"]
                }

                // Try to find a match based on the first part of the available languages (i.e., match "es" for "es-ES")
                for (let language of browserLanguages) {
                    for (let availableLanguage of availableLanguages) {
                        if (language.startsWith(availableLanguage)) {
                            return resultLanguages[availableLanguage]
                        }
                    }
                }
            }

            $.getJSON(prefix + "versions.json", vers => {
                let last = 0
                vers.forEach(ver => {
                    if (ver === "099") {
                        $("#version").append(new Option("Testfire", ver))
                    } else {
                        $("#version").append(new Option(ver[0] + "." + ver[1] + "." + ver[2], ver))
                    }
                    last = ver
                })
                $("#version").val(last)
                version = last
                loadData()
            })

            function loadData() {
                $.getJSON(prefix + "data/mush/" + version + "/WeaponInfoMain.json", weapon_dict => {
                    weapon_data = {}
                    subweapon_data = {}
                    hed_gear = {}
                    clt_gear = {}
                    shs_gear = {}

                    weapon_dict.forEach(item => {
                        if (item.Id < 10000) {
                            weapon_data[item.Id] = item
                        }
                    })

                    $.getJSON(prefix + "data/mush/" + version + "/WeaponInfoSub.json", subweapon_dict => {
                        subweapon_dict.forEach(item => {
                            //if (item["Id"] < 100) {
                            subweapon_data[item.Id] = item
                            //}
                        })
                        $.getJSON(prefix + "data/mush/" + version + "/GearInfoHead.json", hed_dict => {
                            hed_dict.forEach(item => {
                                if (item.Id > 0 && item.HowToGet != "Impossible") {
                                    hed_gear[item.Id] = item
                                }
                            })
                            $.getJSON(prefix + "data/mush/" + version + "/GearInfoClothes.json", clt_dict => {
                                clt_dict.forEach(item => {
                                    if (item.Id > 0 && item.HowToGet != "Impossible") {
                                        clt_gear[item.Id] = item
                                    }
                                })
                                $.getJSON(prefix + "data/mush/" + version + "/GearInfoShoes.json", shs_dict => {
                                    shs_dict.forEach(item => {
                                        if (item.Id > 0 && item.HowToGet != "Impossible") {
                                            shs_gear[item.Id] = item
                                        }
                                    })
                                    change_lang(current_lang)
                                })
                            })
                        })
                    })
                })
            }

            let current_lang = detectSplatoonLanguage()
            if (typeof current_lang === "undefined") {
                current_lang = "EUen"
            }

            window.change_lang = lang => {
                current_lang = lang
                $.getJSON(prefix + "data/language/" + current_lang + ".json", d => {
                    for (const [key, value] of Object.entries(d)) {
                        lang_dict[key] = value
                    }
                    translate_menu()
                    load_weapons()
                    load_subweapons()
                    load_gear()
                })
            }

            function translate_menu() {
                $("#weapons-tab").text(localize("LayoutMsg/Cmn_CstBase_00", "L_BtnCategory_00-T_Category_00"))
                $("#heads-tab").text(localize("LayoutMsg/Cmn_CstBase_00", "L_BtnCategory_01-T_Category_00"))
                $("#clothes-tab").text(localize("LayoutMsg/Cmn_CstBase_00", "L_BtnCategory_02-T_Category_00"))
                $("#shoes-tab").text(localize("LayoutMsg/Cmn_CstBase_00", "L_BtnCategory_03-T_Category_00"))
                //
            }

            function detailFormatterWeapon(index, row) {
                get_parameter(row["SpecActor"])
                return `<div id="detail-view-${row["SpecActor"]}">a</div>`
            }

            function get_parameter(SpecActor) {
                $.getJSON(
                    prefix + "data/parameter/" + version + "/weapon/" + SpecActor + ".game__GameParameterTable.json",
                    data => {
                        const formatter = new JSONFormatter(data)
                        console.log($(`#detail-view-${"SpecActor"}`))
                        $(`#detail-view-${"SpecActor"}`).append(formatter.render())
                    }
                )
            }

            const get_name = val => val.split(".")[0].substring(10)

            function load_weapons() {
                const data = []
                for (const weapon of Object.values(weapon_data)) {
                    if (weapon["Id"] < 20000) {
                        const row = {
                            Id: weapon["Id"],
                            NameClean: weapon["__RowId"],
                            InternalName: weapon["__RowId"],
                            Name: localize("CommonMsg/Weapon/WeaponName_Main", weapon["__RowId"]),
                            Sub: [
                                get_name(weapon["SubWeapon"]),
                                localize("CommonMsg/Weapon/WeaponName_Sub", get_name(weapon["SubWeapon"])),
                            ],
                            Special: [
                                get_name(weapon["SpecialWeapon"]),
                                localize("CommonMsg/Weapon/WeaponName_Special", get_name(weapon["SpecialWeapon"])),
                            ],
                            SpecialPoint: weapon["SpecialPoint"],
                            Range: weapon["Range"],
                            RewardLvl2: weapon["RewardLv2"],
                            RewardLvl3: weapon["RewardLv3"],
                            RewardLvl4: weapon["RewardLv4"],
                            RewardLvl5: weapon["RewardLv5"],
                            Season: weapon["Season"],
                            ShopUnlockRank: weapon["ShopUnlockRank"],
                            UIParam: weapon["UIParam"],
                            SpecActor: weapon["SpecActor"]
                                .replace("Work/Actor/", "")
                                .replace(".engine__actor__ActorParam.gyml", ""),
                        }
                        data.push(row)
                    }
                }
                $("#weapon-table").bootstrapTable("refreshOptions", {
                    data: data,
                })
            }

            function load_subweapons() {
                const subdata = []
                for (const subweapon in Object.values(subweapon_data)) {
                    if (subweapon["Id"] < 100) {
                        const row = {
                            Id: subweapon["Id"],
                            NameClean: subweapon["__RowId"],
                            Name: localize("CommonMsg/Weapon/WeaponExp_Sub", subweapon["__RowId"]),
                        }
                        subdata.push(row)
                    }
                }
                $("#subweapon-table").bootstrapTable("refreshOptions", { data: subdata })
            }

            function load_gear_into_table(ref_table, dir_name, ref_dict) {
                const geardata = []
                for (const gear of Object.values(ref_dict)) {
                    const gearname = gear["__RowId"].substring(4)
                    if (gearname in lang_dict["CommonMsg/Gear/" + dir_name]) {
                        const row = {
                            Id: gear["Id"],
                            NameClean: gear["__RowId"],
                            Name: localize("CommonMsg/Gear/" + dir_name, gearname),
                            Brand: gear["Brand"],
                            Price: gear["Price"],
                            Rarity: gear["Rarity"],
                            Skill0: gear["Skill"],
                            HowToGet: gear["HowToGet"],
                            Season: gear["Season"],
                        }
                        geardata.push(row)
                    }
                }
                $(ref_table).bootstrapTable("refreshOptions", { data: geardata })
            }

            function load_gear() {
                load_gear_into_table("#heads-table", "GearName_Head", hed_gear)
                load_gear_into_table("#clothes-table", "GearName_Clothes", clt_gear)
                load_gear_into_table("#shoes-table", "GearName_Shoes", shs_gear)
            }

            $(function () {
                $("#weapon-table").bootstrapTable({})
                $("#subweapon-table").bootstrapTable({})
                $("#heads-table").bootstrapTable({})
                $("#clothes-table").bootstrapTable({})
                $("#shoes-table").bootstrapTable({})
                $("#language").val(current_lang)
                $("#language").change(function () {
                    change_lang($(this).val())
                })
                $("#version").change(() => {
                    version = $(this).val()
                    loadData()
                })
            })
        </script>
        <footer class="footer" id="footer">
            <script type="module">
                import { generateFooter } from "./js/Utility.js"
                generateFooter($("#footer"))
            </script>
        </footer>
    </body>
</html>
